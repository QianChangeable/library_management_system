# SQL 文件说明

本目录包含图书馆管理系统使用的所有SQL语句，按功能分类并标注用途。

## 文件结构

### 1. table_create.sql
- **用途**: 创建系统所需的数据库表结构
- **包含**: 
  - 学生表 (students)
  - 图书表 (books) 
  - 借阅记录表 (borrow_records)

### 2. all_operations.sql
- **用途**: 包含项目中所有使用的SQL操作语句，按功能分类
- **分类**:
  - 表结构创建
  - 学生相关操作
  - 图书相关操作  
  - 借阅相关操作
  - 事务操作
  - 测试数据

### 3. test_data.sql
- **用途**: 插入测试数据用于开发和测试
- **包含**:
  - 测试学生数据
  - 测试图书数据
  - 测试借阅记录

## 事务处理说明

系统在以下业务场景中使用事务处理：

### 借书事务 (`BorrowBook`)
- 检查学生是否可以借书
- 检查书籍是否可以借阅  
- 创建借阅记录
- 减少书籍可借阅数量

### 还书事务 (`ReturnBook`)
- 检查是否逾期并计算罚款
- 执行还书操作
- 增加书籍可借阅数量
- 如果有逾期罚款，禁用学生借阅权限

### 支付罚款事务 (`PayFine`)
- 检查是否还有未支付的罚款
- 启用学生借阅权限

## 使用说明

1. **初始化数据库**: 先执行 `table_create.sql` 创建表结构
2. **插入测试数据**: 执行 `test_data.sql` 插入测试数据
3. **业务操作**: 参考 `all_operations.sql` 中的SQL语句进行开发

## 注意事项

- 所有SQL语句都使用参数化查询 (`?` 占位符) 防止SQL注入
- 外键约束确保数据完整性
- 事务处理保证业务操作的原子性
